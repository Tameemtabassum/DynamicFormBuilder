@model List<DynamicFormBuilder.ViewModels.EmployeeChangeHistoriesViewModel>

@if (Model != null && Model.Any())
{
    var employee = Model.First();
    <div class="card mb-3 shadow-sm">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">Employee Information</h5>
        </div>
        <div class="card-body">
            <p class="mb-0"><strong>Employee ID:</strong> @employee.EmployeeId</p>
        </div>
    </div>

    <div class="card shadow-sm">
        <div class="card-header bg-secondary text-white">
            <h5 class="mb-0">Change History Records (@Model.Count)</h5>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-striped table-bordered mb-0">
                    <thead class="table-dark">
                        <tr>
                            <th style="width: 15%;">Changed At</th>
                            <th style="width: 42.5%;">Previous Data</th>
                            <th style="width: 42.5%;">Updated Data</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var history in Model)
                        {
                            <tr>
                                <td class="align-top">
                                    <strong>@history.ChangedAt.ToString("dd/MM/yyyy")</strong><br />
                                    <small class="text-muted">@history.ChangedAt.ToString("HH:mm:ss")</small>
                                </td>
                                <td class="align-top">
                                    <pre class="mb-0">@history.PreviousData</pre>
                                </td>
                                <td class="align-top">
                                    <pre class="mb-0">@history.UpdatedData</pre>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
}
else
{
    <div class="alert alert-warning">
        <h5><i class="bi bi-exclamation-triangle"></i> No History Found</h5>
        <p class="mb-0">@(ViewBag.Message ?? "No change history records found for this employee.")</p>
    </div>
}

<style>
    pre {
        white-space: pre-wrap;
        word-wrap: break-word;
        max-height: 200px;
        overflow-y: auto;
        font-size: 0.85rem;
        background-color: #f8f9fa;
        padding: 10px;
        border-radius: 4px;
        border: 1px solid #dee2e6;
    }

    .align-top {
        vertical-align: top;
    }

    .table-responsive {
        max-height: 500px;
    }
</style>